function addInit(){reserves=null,rate=null,setInterval(function(){let a=[];if(a.push(TOKENS[$("#display-token-A").text().trim()]),a.push(TOKENS[$("#display-token-B").text().trim()]),a&&2==a.length&&null!=a[0]&&null!=a[1]){let o=[];for(let e=0;e<a.length;e++)o.push(a[e]);o=o.sort(function(e,t){return t<e?1:e<t?-1:t==e?0:void 0}),getPair(a,function(e,t){getReserves(t,function(e,t){o[0]!=a[0]&&(n=t[0],t[0]=t[1],t[1]=n),reserves=t;var n=TOKENDECIMALS[$("#display-token-A").text().trim()],t=TOKENDECIMALS[$("#display-token-B").text().trim()];rate=Math.pow(10,n)*reserves[1]/(Math.pow(10,t)*reserves[0]),$("#rate-amount-B").text(formatNumber(rate)),0<$("#input-A").val()&&getMatchingAmount()})}),selectedAccount&&(getAllowance(a[0],selectedAccount,ADDRESS_ROUTER,function(e,t){$(".approveBtn1").attr("data-token",a[0]),0<t&&($(".approveBtn1").hide(),"none"!=$(".approveBtn2")[0].style.display&&$(".add-card-add-btn").show())}),getAllowance(a[1],selectedAccount,ADDRESS_ROUTER,function(e,t){$(".approveBtn2").attr("data-token",a[1]),0<t&&($(".approveBtn2").hide(),"none"!=$(".approveBtn1")[0].style.display&&$(".add-card-add-btn").show())}))}},3e3),setInterval(function(){var e;!selectedAccount||(e=TOKENS[$("#display-token-A").text().trim()])&&null!=e&&getBalance(e,function(e,t){$("#balance-token-A").text(formatBalance(t,4,$("#display-token-A").text().trim())),$("#balance-token-A").attr("data-bal",t)})},3e3),setInterval(function(){var e;!selectedAccount||(e=TOKENS[$("#display-token-B").text().trim()])&&null!=e&&getBalance(e,function(e,t){$("#balance-token-B").text(formatBalance(t,4,$("#display-token-B").text().trim())),$("#balance-token-B").attr("data-bal",t)})},3e3),$("#input-A").focus(function(){$(this).select()}),$("#input-A").change(function(){getMatchingAmount()}),$("#input-A").keyup(function(){getMatchingAmount()}),document.querySelector(".add-card-add-btn").addEventListener("click",function(){addLiquidity(TOKENS[$("#display-token-A").text().trim()],TOKENS[$("#display-token-B").text().trim()],$("#input-A").val()*Math.pow(10,TOKENDECIMALS[$("#display-token-A").text().trim()]),$("#input-B").val()*Math.pow(10,TOKENDECIMALS[$("#display-token-B").text().trim()]),function(e,t){console.log(e,t)})}),document.querySelectorAll(".add-card-approve-btn").forEach(e=>{e.addEventListener("click",function(){approveToken($(this).data("token"),ADDRESS_ROUTER,function(e,t){console.log(e,t)})})}),document.getElementById("token-select-A").onclick=function(){document.getElementById("tokenModal").style.display="block",changeToken="A"},document.getElementById("token-select-B").onclick=function(){document.getElementById("tokenModal").style.display="block",changeToken="B"},$(".token-element").click(function(){const e=$(this).attr("value");"A"==changeToken?(tokenA=e,$("#display-token-A").html(`<div class="token-select"><img width="20" src="/images/coins/${e.toLowerCase()}.png"></img> ${e}</div><span class="caret"></span>`),$(".approveBtn1").text("Approve "+tokenA),$(".approveBtn1").show(),$("#rate-currency-A").text(tokenA)):(tokenB=e,$("#display-token-B").html(`<div class="token-select"><img width="20" src="/images/coins/${e.toLowerCase()}.png"></img> ${e}</div><span class="caret"></span>`),$(".approveBtn2").text("Approve "+tokenB),$(".approveBtn2").show(),$("#rate-currency-B").text(tokenB)),document.getElementById("tokenModal").style.display="none"}),document.getElementById("closeTokenModal").onclick=function(){document.getElementById("tokenModal").style.display="none"},window.onclick=function(e){e.target==document.getElementById("tokenModal")&&(document.getElementById("tokenModal").style.display="none")}}function getPair(e,t){let n=new dweb3.eth.Contract(ABI_FACTORY,ADDRESS_FACTORY);n.methods.getPair(e[0],e[1]).call().then(function(e){t(null,e)})}function getMatchingAmount(){var e;reserves&&rate&&(e=Number($("#input-A").val())*rate,$("#input-B").val(e))}function renderStats(){$("#gft-price").text("1 GFT = "+gftPrice+" USDC"),$("#total-tvl").text("$"+numberWithCommas(sumTvl/Math.pow(10,18))),$("#supply").text(numberWithCommas(supply,0)),$("#mcap").text("$"+numberWithCommas(marketcap)),$("#holders").text(holders)}function fetchApi(){console.log("Fetching from api.."),fetch("https://api.stepfarm.io/stats").then(e=>e.json()).then(e=>{gftPrice=e.gftPrice,gmtPrice=e.gmtPrice,supply=e.supply,marketcap=e.marketcap,holders=e.holders,sumTvl=e.sumTvl,tvl=e.tvl,renderStats(),renderFarmStats();var t=document.querySelector(".counter1");for(let e=1;e<=4;e++){const n=document.querySelector(".counter"+e),o=window.counterUp.default;new Waypoint({element:t,handler:function(){o(n,{duration:3e3,delay:16}),this.destroy()},offset:"80%"})}}).catch(e=>{console.error(e),console.log("API error, contact devs")})}gftPrice=0,gmtPrice=0,supply=0,marketcap=0,holders=0,sumTvl=0,tvl=[],fetchApi();let farmMaxAmount=null;function renderFarmStats(){for(let e=0;e<POOLS.length;e++){var t=tvl[e],n=e,o=($("#farm"+n+"-tvl").text("$"+formatBalance(t,0)),POOLS[n].gftPerBlock*BLOCK_PER_DAY*365*gftPrice),o=o/t,o=Math.round(1e3*o)/100;$("#farm"+n+"-apr").text(o+"%"),$(".farm-card-stats-"+n).show(),$(".spinner-"+n).hide()}}function checkCardsApproval(){if(selectedAccount)for(let e=0;e<POOLS.length;e++){let n=e;getAllowance(POOLS[n].lpToken,selectedAccount,ADDRESS_MASTERCHEF,function(e,t){0<t?($("#farm"+n+"-approve").hide(),$(`#farm${n}-deposit`).show(),$(`#farm${n}-withdraw`).show()):($(`#farm${n}-deposit`).hide(),$(`#farm${n}-withdraw`).hide(),$("#farm"+n+"-approve").show())})}}function farmConnectInit(){checkCardsApproval()}async function farmInit(){for(let i=0;i<POOLS.length;i++){tvl[i];let e=POOLS[i],n=i,t=e.pair[0]+"-"+e.pair[1]+" LP",o=e.pair[0]+"-"+e.pair[1],a="";e.pair[0]===e.pair[1]&&(o=e.pair[0]+" Staking",t=e.pair[0],a="display:none"),$("#farm-cards").append(`
      <div class="farm-card col-md-3" data-pid="${n}" data-address="${e.lpToken}">
        <div class="farm-card-header">
          <div id="farm-card-symbol">
            <img id="farm-coin-A" src="/images/coins/${e.pair[0].toLowerCase()}.png" style="${a}"></img>
            <img id="farm-coin-B" src="/images/coins/${e.pair[1].toLowerCase()}.png"></img>
          </div>
          <div class="farm-card-block">
            <span id="farm-card-display">${o}</span>
            <div class="farm-card-title">
              <img src="/images/icons/core.svg"></img>
              <div class="multiplier">${e.multiplier}</div>
            </div>
          </div>
        </div>

        <!-- <center><div class="sk-chase spinner-${n}">
          <div class="sk-chase-dot"></div>
          <div class="sk-chase-dot"></div>
          <div class="sk-chase-dot"></div>
          <div class="sk-chase-dot"></div>
          <div class="sk-chase-dot"></div>
          <div class="sk-chase-dot"></div>
        </div></center> -->

        <div class="farm-card-stats farm-card-stats-${n}" style="display: block;">
          <p>Earn<span style="float: right;">GFT</span></p>
          <p>APR<span style="float: right;" id="farm${n}-apr">%</span></p>
          <p>TVL<span style="float: right;" id="farm${n}-tvl">$0.00</span></p>
        </div>

        <div class="farm-card-earned">
          <div class="farm-card-earned-display"><span style="color: #00E8E7;">GFT</span> EARNED</div>
          <div class="farm-card-earned-amount">
            <h3 id="farm${n}-earned">0</h3>
            <button class="farm-card-harvest-btn" id="farm${n}-harvest">Harvest</button>
          </div>
          <div class="farm-card-staked">
            <span style="color: #00E8E7;">${t}</span> STAKED
            <h3 id="farm${n}-staked">0</h3>
            <div class="farm-card-actions">
              <button class="farm-card-approve-btn" id="farm${n}-approve">Approve ${t}</button>
              <button class="farm-card-deposit-btn" style="display: none" id="farm${n}-deposit">Deposit</button>
              <button class="farm-card-withdraw-btn" style="display: none" id="farm${n}-withdraw">Withdraw</button>
            </div>
          </div>
        </div>
        
        <div class="farm-card-connect">
          <button class="farm-card-connect-btn" style="display: none">Connect Wallet</button>
        </div>
      </div>`),setTimeout(function(){renderFarmStats()},100+300*i),setInterval(function(){selectedAccount&&(userInfo(n,function(e,t){t=formatBalance(t.amount,18).toFixed(18);$("#farm"+n+"-staked").text(t)}),pendingGft(n,function(e,t){$("#farm"+n+"-earned").text(formatBalance(t,3))}))},3e3+300*i),window.onclick=function(e){e.target==document.getElementById("withdrawModal")&&(document.getElementById("withdrawModal").style.display="none"),e.target==document.getElementById("withdrawModal")&&(document.getElementById("withdrawModal").style.display="none")},document.getElementById("maxTrade").onclick=function(){$("#input-A").val(farmMaxAmount)},document.getElementById("closeWithdrawModal").onclick=function(){document.getElementById("withdrawModal").style.display="none"},document.querySelector("#farm"+n+"-harvest").addEventListener("click",function(e){var t=$(this).parent().parent().parent().data("pid");0==t?harvestStaking():harvestFarm(t)}),document.querySelector("#farm"+n+"-deposit").addEventListener("click",function(e){let n=$(this).parent().parent().parent().parent().data("pid"),o=(document.getElementById("withdrawModal").style.display="block",$(".farm-modal-title").text("DEPOSIT "+POOLS[n].name),$("#token-balance-disp").text(POOLS[n].name),$(this).parent().parent().parent().parent().data("address"));$("#farm-modal-action").text("DEPOSIT"),0==n?getBalance(TOKENS.GFT,function(e,t){t=t.toString();farmMaxAmount=StringAmountConstructor(t),$("#token-balance-A").text(farmMaxAmount),document.getElementById("farm-modal-action").onclick=function(){document.getElementById("withdrawModal").style.display="none",enterStaking()}}):getBalance(o,function(e,t){t=t.toString();farmMaxAmount=StringAmountConstructor(t),$("#token-balance-A").text(farmMaxAmount),document.getElementById("farm-modal-action").onclick=function(){document.getElementById("withdrawModal").style.display="none",deposit(o,n)}})}),document.querySelector("#farm"+n+"-withdraw").addEventListener("click",function(e){let n=$(this).parent().parent().parent().parent().data("pid");document.getElementById("withdrawModal").style.display="block",$(".farm-modal-title").text("WITHDRAW "+POOLS[n].name),$("#token-balance-disp").text(POOLS[n].name),$("#farm-modal-action").text("WITHDRAW"),0==n?userInfo(n,function(e,t){t=t.amount.toString();farmMaxAmount=StringAmountConstructor(t),$("#token-balance-A").text(farmMaxAmount),document.getElementById("farm-modal-action").onclick=function(){document.getElementById("withdrawModal").style.display="none",leaveStaking()}}):userInfo(n,function(e,t){t=t.amount.toString();farmMaxAmount=StringAmountConstructor(t),$("#token-balance-A").text(farmMaxAmount),document.getElementById("farm-modal-action").onclick=function(){document.getElementById("withdrawModal").style.display="none",withdraw(n)}})}),document.querySelector("#farm"+n+"-approve").addEventListener("click",function(e){if(!selectedAccount)return onConnect();var t=$(this).parent().parent().parent().parent().data("pid");approveToken(POOLS[t].lpToken,ADDRESS_MASTERCHEF,function(e,t){console.log(e,t),checkCardsApproval()})})}checkCardsApproval()}function getMultiplier(){var e=prompt("Enter _from number","0"),t=prompt("Enter _to number","0");let n=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.getMultiplier(e,t).call().then(function(e){console.log(e)})}function setMultiplier(){var e=prompt("Please enter new multiplier","1");let t=new Web3(provider),n=new t.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.updateMultiplier(e).send({from:selectedAccount})}function poolLength(){let e=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);e.methods.poolLength().call().then(function(e){console.log(e)})}function addPair(){var e=prompt("New pair allocation points","1"),t=prompt("New LP address","0x"),n=prompt("With or without mass update?","0");let o=new Web3(provider),a=new o.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);a.methods.add(e,t,n).send({from:selectedAccount})}function setPair(){var e=prompt("Pair to update PID?","0"),t=prompt("New pair allocation points","1"),n=prompt("With or without mass update?","0");let o=new Web3(provider),a=new o.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);a.methods.set(e,t,n).send({from:selectedAccount})}function deposit(e,t){$("#body-overlay").show();var n=BigIntConstructor($("#input-A").val());let o=new Web3(provider),a=new o.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);a.methods.deposit(t,n).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function withdraw(e){$("#body-overlay").show();var t=BigIntConstructor($("#input-A").val());let n=new Web3(provider),o=new n.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);o.methods.withdraw(e,t).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function harvestFarm(e){$("#body-overlay").show();let t=new Web3(provider),n=new t.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.deposit(e,0).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function enterStaking(){$("#body-overlay").show();var e=BigIntConstructor($("#input-A").val());let t=new Web3(provider),n=new t.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.enterStaking(e).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function leaveStaking(){$("#body-overlay").show();var e=BigIntConstructor($("#input-A").val());let t=new Web3(provider),n=new t.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.leaveStaking(e).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function harvestStaking(){if($("#body-overlay").show(),!selectedAccount)return onConnect();let e=new Web3(provider),t=new e.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);t.methods.enterStaking(0).send({from:selectedAccount}).then(()=>$("#body-overlay").hide()).catch(e=>{console.error(e),$("#body-overlay").hide()})}function poolInfo(e,t){let n=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.poolInfo(e).call().then(function(e){t(null,e)})}function userInfo(e,t){let n=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.userInfo(e,selectedAccount).call().then(function(e){t(null,e)})}function pendingGft(e,t){let n=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.pendingCake(e,selectedAccount).call().then(function(e){t(null,e)})}function getStartBlock(){let e=new dweb3.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);e.methods.startBlock().call().then(function(e){console.log(e)})}function setDevAddress(){var e=prompt("New dev address","0x");let t=new Web3(provider),n=new t.eth.Contract(ABI_MASTERCHEF,ADDRESS_MASTERCHEF);n.methods.dev(e).send({from:selectedAccount})}function BigIntConstructor(t){let n=BigInt(0),o=!1,a=0;for(let e=0;e<t.length;e++)"."==t[e]?o=!0:(o&&a++,n=(n*=BigInt(10))+BigInt(t[e]));return o?a<18&&(n*=BigInt(Math.pow(10,18-a))):n*=BigInt(Math.pow(10,18)),n}function StringAmountConstructor(t){if(18<t.length)farmMaxAmount=t.substr(0,t.length-18)+"."+t.substr(t.length-18);else{farmMaxAmount="0.";for(let e=0;e<18-t.length;e++)farmMaxAmount+="0";farmMaxAmount+=t}return farmMaxAmount}function formatBalance(e,t=4,n=null){let o=18;n=(o=null!=n?TOKENDECIMALS[n]:o)-t;return Math.round(e/Math.pow(10,n))/Math.pow(10,t)}function formatNumber(e,t=6){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function approveToken(e,t,n){$("#body-overlay").show();let o=new Web3(provider),a=new o.eth.Contract(ABI_ERC20,e);a.methods.approve(t,"115792089237316195423570985008687907853269984665640564039457584007913129639935").send({from:selectedAccount}).then(function(e){$("#body-overlay").hide(),n(null,e)}).catch(e=>{$("#body-overlay").hide(),console.error(e)})}function disapproveToken(e,t,n){let o=new Web3(provider),a=new o.eth.Contract(ABI_ERC20,e);a.methods.approve(t,"0").send({from:selectedAccount}).then(function(e){n(null,e)})}function getBalance(e,t){let n=new dweb3.eth.Contract(ABI_ERC20,e);n.methods.balanceOf(selectedAccount).call().then(function(e){t(null,e)})}function getBalanceOf(e,t,n){let o=new dweb3.eth.Contract(ABI_ERC20,e);o.methods.balanceOf(t).call().then(function(e){n(null,e)})}function getAllowance(e,t,n,o){let a=new dweb3.eth.Contract(ABI_ERC20,e);a.methods.allowance(t,n).call().then(function(e){o(null,e)})}function getSupply(e,t){let n=new dweb3.eth.Contract(ABI_ERC20,e);n.methods.totalSupply().call().then(function(e){t(null,e)})}function addEmail(){$.post(STEPFARM_API+"/mailing",{email:email.value}).done(function(e){console.log(e),alert(e)})}function numberWithCommas(e,t=2){return parseFloat(e).toFixed(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")}function fadeColor(){console.log("highlighting"),$("#start").toggle("highlight"),$("#start").toggle("highlight")}function indexInit(){$(document).ready(function(){fetchApi();var t=["start","1"],n=["<p>We have many features to discover, but everything is secret until the right time! Follow the path and find out regularly what will be the next feature on our roadmap. StepFarm gives wings to your yield!</p>","<p>STAKING & <br> FARMING</p>"];for(let e=0;e<t.length;e++){const o=t[e],a=($(".roadmap-description-"+o).html(n[e]),$(".district-"+o));a.mouseover(()=>{$(".roadmap-description-"+o).fadeIn("fast"),a.css("fill","black")}),a.mouseout(()=>{$(".roadmap-description-"+o).fadeOut("fast"),a.css("fill","#00E8E7")})}var e=document.querySelector("#start");new Waypoint({element:e,handler:function(){fadeColor(),this.destroy()},offset:"50%"})}),window.addEventListener("resize",function(){viewportWidth<=544?($(".hero").attr("src","/images/hero-mobile.svg"),$(".shoe-mobile").show(),$(".stats-rows").hide()):($(".hero").attr("src","/images/hero.svg"),$(".stat").show(),$(".stats-rows").show(),$(".shoe-mobile").hide())},!1),viewportWidth<=544?($(".hero").attr("src","/images/hero-mobile.svg"),$(".shoe-mobile").show(),$(".stats-rows").hide()):($(".hero").attr("src","/images/hero.svg"),$(".stat").show(),$(".stats-rows").show(),$(".shoe-mobile").hide())}function liquidityConnectInit(){for(let e=1;e<POOLS.length;e++){let n=e;getBalance(POOLS[e].lpToken,function(e,t){let o=POOLS[n];if($("#liq-"+o.lpToken)&&$("#liq-"+o.lpToken).remove(),0!=t){var a=formatBalance(t);let n=`
        <div id="liq-${o.lpToken}">
          <h3>${o.pair[0]}-${o.pair[1]} LP: ${a}</h3>
          <button id="approve-${o.lpToken}" class="liquidity-approve-btn">Approve ${o.pair[0]}-${o.pair[1]} LP</button>
          <button style="display:none" data-bal="${t}" id="remove-${o.lpToken}" class="liquidity-remove-btn">- Remove</button>
        </div>
      `;getAllowance(o.lpToken,selectedAccount,ADDRESS_ROUTER,function(e,t){$("#list-liqs").append(n),0<t&&($("#approve-"+o.lpToken).hide(),$("#remove-"+o.lpToken).show()),document.querySelector("#approve-"+o.lpToken).addEventListener("click",function(){approveToken(o.lpToken,ADDRESS_ROUTER,function(e,t){console.log(e,t),e||($("#approve-"+o.lpToken).hide(),$("#remove-"+o.lpToken).show())})}),document.querySelector("#remove-"+o.lpToken).addEventListener("click",function(){var e=$(this).data("bal"),e=prompt("Amount to withdraw?",e);removeLiquidity(TOKENS[o.pair[0]],TOKENS[o.pair[1]],e,function(e,t){console.log(e,t)})})})}})}}function liquidityInit(){selectedAccount&&liquidityConnectInit(),document.querySelector(".farm-liquidity-connect-btn").addEventListener("click",function(e){if(!selectedAccount)return onConnect();window.location.href="/#add"})}(dweb3=new Web3(PUBLIC_NODE_URL)).eth.getChainId().then(e=>console.log("chain id: "+e)),ABI_ERC20=null,$.getJSON("abi/PancakeERC20.json",function(e){ABI_ERC20=e.abi}),ABI_FACTORY=null,$.getJSON("abi/PancakeFactory.json",function(e){ABI_FACTORY=e.abi}),ABI_ROUTER=null,$.getJSON("abi/PancakeRouter.json",function(e){ABI_ROUTER=e.abi}),ABI_PAIR=null,$.getJSON("abi/PancakePair.json",function(e){ABI_PAIR=e.abi}),ABI_MASTERCHEF=null,$.getJSON("abi/MasterChef.json",function(e){ABI_MASTERCHEF=e.abi});const routes={404:{template:"/pages/404.html",title:"404",description:"Page not found"},"/":{template:"/pages/index.html",title:"Home",description:"This is the home page"},swap:{template:"/pages/swap.html",title:"Swap",description:"This is the swap page"},contact:{template:"/pages/contact.html",title:"Contact Us",description:"This is the contact page"},earn:{template:"/pages/earn.html",title:"Staking & Yield Farming",description:"This is the staking & yield farming page"},liquidity:{template:"/pages/liquidity.html",title:"Liquidity | Step Farm",description:"This is the page where you can check your liquidity"},add:{template:"/pages/add.html",title:"Add Liquidity | Step Farm",description:"This is the page where you can provide liquidity"}},locationHandler=async()=>{var e=window.location.hash.replace("#",""),t=(0==e.length&&(e="/"),routes[e]||routes[404]),n=await fetch(t.template).then(e=>e.text());switch(document.getElementById("content").innerHTML=n,document.title=t.title,document.querySelector('meta[name="description"]').setAttribute("content",t.description),e){case"/":indexInit();break;case"swap":swapInit();break;case"earn":farmInit();break;case"add":addInit();break;case"liquidity":liquidityInit();break;default:console.log("Unknown route: "+e)}};function tokenAChanged(){$("#approve-swap").show(),$("#confirm-swap").hide();var e=$("#display-token-A").text().trim(),t=TOKENS[e];$("#token-balance-disp").text(e),$("#approve-swap").text("Approve "+e),selectedAccount&&(getBalance(t,function(e,t){$("#token-balance-A").data("data-bal",t),$("#token-balance-A").text(formatBalance(t,4,$("#display-token-A").text().trim()))}),getAllowance(t,selectedAccount,ADDRESS_ROUTER,function(e,t){0<t&&($("#approve-swap").hide(),$("#confirm-swap").show())}))}function swapConnectInit(){tokenAChanged()}function swapInit(){swapRateInverted=!1;let t=Object.keys(TOKENS)[0],n=Object.keys(TOKENS)[1];$("#swap-card-container-A").html(`<button class="btn btn-default dropdown-toggle swap-card-token-btn" type="button" id="token-select-A" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
      <div id="display-token-A">
        <img width="20" src="/images/coins/${t.toLowerCase()}.png"></img>${t}<span class="caret"></span>
      </div>
    </button>
    <input id="input-A" value="0" type="number" style="float:right; width: 70%;" class="swap-card-balance"></input>`),$("#swap-card-container-B").html(`<button class="btn btn-default dropdown-toggle swap-card-token-btn" type="button" id="token-select-B" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
      <div id="display-token-B">
        <img width="20" src="/images/coins/${n.toLowerCase()}.png"></img>${n}<span class="caret"></span>
      </div>
    </button>
    <input disabled id="input-B" value="0" type="number" style="float:right; width: 70%;" class="swap-card-balance"></input>`),$(".swap-tokens-btn").hover(function(){$(this).find("img").attr("src",function(e,t){return t.replace("images/swap/arrow.svg","images/swap/arrows.svg")})},function(){$(this).find("img").attr("src",function(e,t){return t.replace("images/swap/arrows.svg","images/swap/arrow.svg")})}),$(".swap-tokens-btn").click(function(){let e=$("#display-token-A").text().trim(),t=$("#display-token-B").text().trim();$("#display-token-A").html(`<div class="token-select"><img width="20" src="/images/coins/${t.toLowerCase()}.png"></img> ${t}</div><span class="caret"></span>`),$("#display-token-B").html(`<div class="token-select"><img width="20" src="/images/coins/${e.toLowerCase()}.png"></img> ${e}</div><span class="caret"></span>`),getQuote(),tokenAChanged()});var o="A";document.getElementById("deadline").value=DEADLINE_MIN,$("#slippage-1").click(function(){SLIPPAGE_TOLERANCE=.1,$("#slippage-1").removeClass("active"),$("#slippage-2").removeClass("active"),$("#slippage-3").removeClass("active"),CUSTOM_SLIPPAGE||$("#slippage-1").addClass("active")}),$("#slippage-2").click(function(){SLIPPAGE_TOLERANCE=.5,$("#slippage-1").removeClass("active"),$("#slippage-2").removeClass("active"),$("#slippage-3").removeClass("active"),$("#slippage-2").addClass("active")}),$("#slippage-3").click(function(){SLIPPAGE_TOLERANCE=1,$("#slippage-1").removeClass("active"),$("#slippage-2").removeClass("active"),$("#slippage-3").removeClass("active"),$("#slippage-3").addClass("active")}),$("#speed-1").click(function(){SPEED=5,$("#speed-1").removeClass("active"),$("#speed-2").removeClass("active"),$("#speed-3").removeClass("active"),CUSTOM_SLIPPAGE||$("#speed-1").addClass("active")}),$("#speed-2").click(function(){SPEED=6,$("#speed-1").removeClass("active"),$("#speed-2").removeClass("active"),$("#speed-3").removeClass("active"),$("#speed-2").addClass("active")}),$("#speed-3").click(function(){SPEED=7,$("#speed-1").removeClass("active"),$("#speed-2").removeClass("active"),$("#speed-3").removeClass("active"),$("#speed-3").addClass("active")}),document.getElementById("settingsModalTrigger").onclick=function(){document.getElementById("settingsModal").style.display="block"},document.getElementById("closeSettingsModal").onclick=function(){document.getElementById("settingsModal").style.display="none"},window.onclick=function(e){e.target==document.getElementById("settingsModal")&&(document.getElementById("settingsModal").style.display="none"),e.target==document.getElementById("tokenModal")&&(document.getElementById("tokenModal").style.display="none")},document.getElementById("token-select-A").onclick=function(){document.getElementById("tokenModal").style.display="block",o="A"},document.getElementById("token-select-B").onclick=function(){document.getElementById("tokenModal").style.display="block",o="B"},$(".token-element").click(function(){const e=$(this).attr("value");"A"==o?(t=e,$("#display-token-A").html(`<div class="token-select"><img width="20" src="/images/coins/${e.toLowerCase()}.png"></img> ${e}</div><span class="caret"></span>`),tokenAChanged()):(n=e,$("#display-token-B").html(`<div class="token-select"><img width="20" src="/images/coins/${e.toLowerCase()}.png"></img> ${e}</div><span class="caret"></span>`)),document.getElementById("tokenModal").style.display="none"}),document.getElementById("closeTokenModal").onclick=function(){document.getElementById("tokenModal").style.display="none"},$("#input-A").focus(function(){$(this).select()}),$("#input-A").change(function(){getQuote()}),$("#input-A").keyup(function(){getQuote()}),$("#confirm-swap").click(function(){swap()}),$("#maxTrade").click(function(){var e=TOKENDECIMALS[$("#display-token-A").text().trim()],e=$("#token-balance-A").data("data-bal")/Math.pow(10,e);$("#input-A").val(e),getQuote()}),$("#swap-rate-invert").click(function(){swapRateInverted=!swapRateInverted,getQuote()}),tokenAChanged(),document.querySelector("#approve-swap").addEventListener("click",function(){if(!selectedAccount)return onConnect();var e=$("#display-token-A").text().trim();approveToken(TOKENS[e],ADDRESS_ROUTER,function(e,t){console.log(e,t)})})}function getReserves(e,t){let n=new dweb3.eth.Contract(ABI_PAIR,e);n.methods.getReserves().call().then(function(e){t(null,e)})}function getKLast(){var e=prompt("Please enter LP address","0x");let t=new dweb3.eth.Contract(ABI_PAIR,e);t.methods.kLast().call().then(function(e){console.log(e)})}function getFactoryAddress(){let e=new dweb3.eth.Contract(ABI_ROUTER,ADDRESS_ROUTER);e.methods.factory().call().then(function(e){console.log(e)})}function getFeeTo(){let e=new dweb3.eth.Contract(ABI_FACTORY,ADDRESS_FACTORY);e.methods.feeTo().call().then(function(e){console.log(e)})}function setFeeTo(){var e=prompt("Please enter treasury address","0x0000000000000000000000000000000000000000");let t=new Web3(provider),n=new t.eth.Contract(ABI_FACTORY,ADDRESS_FACTORY);n.methods.setFeeTo(e).send({from:selectedAccount})}function setFeeToSetter(){var e=prompt("Please enter fee setter address","0x0000000000000000000000000000000000000000");let t=new Web3(provider),n=new t.eth.Contract(ABI_FACTORY,ADDRESS_FACTORY);n.methods.setFeeToSetter(e).send({from:selectedAccount})}function addLiquidity(e,t,n,o,a){let i=new Web3(provider),c=new i.eth.Contract(ABI_ROUTER,ADDRESS_ROUTER);var r=Math.round((new Date).getTime()/1e3)+ +ONE_MINUTE;n=BigInt(Math.round(n)),o=BigInt(Math.round(o)),c.methods.addLiquidity(e,t,n.toString(),o.toString(),"1","1",selectedAccount,r).send({from:selectedAccount}).then(function(e){a(null,e)})}function removeLiquidity(e,t,n,o){let a=new Web3(provider),i=new a.eth.Contract(ABI_ROUTER,ADDRESS_ROUTER);var c=Math.round((new Date).getTime()/1e3)+3*ONE_MINUTE;i.methods.removeLiquidity(e,t,n,"1","1",selectedAccount,c).send({from:selectedAccount}).then(function(e){o(null,e)})}function getQuote(){var e=$("#display-token-A").text().trim(),t=$("#display-token-B").text().trim(),n=(console.log($("#input-A").val(),e,t),TOKENS[e]),e=TOKENDECIMALS[e],e=BigInt(Math.round($("#input-A").val()*10**e)),o=TOKENS[t];let a=TOKENDECIMALS[t],i=new dweb3.eth.Contract(ABI_ROUTER,ADDRESS_ROUTER);i.methods.getAmountsOut(e,[n,o]).call().then(function(e){console.log(e);var t=BigInt(e[1]).toString();t/=10**a,$("#input-B").val(t);let n="";n=swapRateInverted?(n=(n+=Math.round(e[0]/e[1]*1e4)/1e4)+(" "+$("#display-token-A").text().trim()))+" per "+$("#display-token-B").text().trim():(n=(n+=Math.round(e[1]/e[0]*1e4)/1e4)+(" "+$("#display-token-B").text().trim()))+" per "+$("#display-token-A").text().trim(),$("#swap-rate").html(n),$(".swap-exchange").show()}).catch(e=>console.error(e))}function swap(){$("#body-overlay").show();var e=$("#display-token-A").text().trim(),t=TOKENS[e],e=TOKENDECIMALS[e],e=BigInt($("#input-A").val()*10**e),n=$("#display-token-B").text().trim(),o=TOKENS[n],n=TOKENDECIMALS[n],n=BigInt(Math.floor($("#input-B").val()*10**n*(1-SLIPPAGE_TOLERANCE)));let a=new Web3(provider),i=new a.eth.Contract(ABI_ROUTER,ADDRESS_ROUTER);t=[t,o],o=Math.round((new Date).getTime()/1e3)+3*ONE_MINUTE;i.methods.swapExactTokensForTokens(e,n,t,selectedAccount,o).send({from:selectedAccount}).then(function(e){tokenAChanged(),$("#body-overlay").hide(),console.log(e)}).catch(e=>{$("#body-overlay").hide(),console.error(e)})}function getPair(){var e=prompt("Please enter index","0");let t=new dweb3.eth.Contract(ABI_FACTORY,ADDRESS_FACTORY);t.methods.allPairs(e).call().then(function(e){console.log(e)})}window.addEventListener("hashchange",locationHandler),locationHandler();var viewportWidth,setViewportWidth=function(){viewportWidth=window.innerWidth||document.documentElement.clientWidth},logWidth=function(){640<viewportWidth?console.log("Wide viewport"):console.log("Small viewport")};setViewportWidth(),logWidth(),window.addEventListener("resize",function(){setViewportWidth(),logWidth()},!1);const Web3Modal=window.Web3Modal.default,WalletConnectProvider=window.WalletConnectProvider.default,Fortmatic=window.Fortmatic,evmChains=window.evmChains,Torus=window.Torus;evmChains.chains.push({chain:"TST",chainId:1337,faucets:[],infoURL:"http://",name:"Ganache",nativeCurrency:{name:"Ganache",symbol:"TEST",decimals:18},network:"ganache",networkId:1337,rpc:[],shortName:"ganache"});let web3Modal,provider,selectedAccount;async function init(){var e={metamask:{},walletconnect:{package:WalletConnectProvider,options:{infuraId:"8043bb2cf99347b1bfadfb233c5325c0"}},"custom-binancechainwallet":{display:{logo:"images/logo/binance-chain-wallet.png",name:"Binance Chain Wallet",description:"Connect to your Binance Chain Wallet"},package:!0,connector:async()=>{let e=null;if(void 0===window.BinanceChain)throw new Error("No Binance Chain Wallet found");e=window.BinanceChain;try{await e.request({method:"eth_requestAccounts"})}catch(e){throw new Error("User Rejected")}return e}}};(web3Modal=new Web3Modal({cacheProvider:!0,providerOptions:e,disableInjectedProvider:!1})).cachedProvider&&onConnect(!0)}function suggestNetworkChange(){provider.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x"+Number(56).toString(16)}]})}async function fetchAccountData(){const e=new Web3(provider);console.log("Web3 instance is",e);var t=await e.eth.getChainId(),t=evmChains.getChain(t),n=await e.eth.getAccounts(),o=(selectedAccount=n[0],$("#wallet").html(`<img class="wallet-icon" src="images/wallet.svg"></img><div class="wallet-address">${selectedAccount.substring(0,2)}...${selectedAccount.substring(selectedAccount.length-4,selectedAccount.length)}</div>`),$("#wallet").css("cursor","pointer"),$(".connect-wallet-btn").css("background","#37E4E5"),$("#wallet").on("click",suggestNetworkChange),t.name!==CHAIN_NAME&&(alert("Wrong chain"),$(".connect-wallet-btn").css("background","#FF4500"),$(".wallet-icon").attr("src","images/icons/arrows-rotate-solid.svg"),$(".wallet-address").css("margin","6%"),$(".wallet-address").css("font-size",12),$(".wallet-address").text("Change Network")),window.location.hash.replace("#",""));switch(o=0==o.length?"/":o){case"/":break;case"swap":swapConnectInit();break;case"earn":farmConnectInit();break;case"add":break;case"liquidity":liquidityConnectInit();break;default:console.log("Unknown route: "+o)}}async function refreshAccountData(){document.querySelector("#btn-connect").setAttribute("disabled","disabled"),await fetchAccountData(provider),document.querySelector("#btn-connect").removeAttribute("disabled")}async function onConnect(e=!1){e||web3Modal.clearCachedProvider();try{provider=await web3Modal.connect(),$("#btn-connect").hide(),$("#wallet-dropdown").show()}catch(e){return}provider.on("accountsChanged",e=>{fetchAccountData()}),provider.on("chainChanged",e=>{fetchAccountData()}),provider.on("networkChanged",e=>{fetchAccountData()}),await refreshAccountData()}async function onDisconnect(){provider.close&&await provider.close(),await web3Modal.clearCachedProvider(),provider=null,selectedAccount=null,$("#wallet-dropdown").hide(),$("#btn-connect").show()}window.addEventListener("load",async()=>{init(),document.querySelector("#btn-connect").addEventListener("click",onConnect),document.querySelector("#btn-disconnect").addEventListener("click",onDisconnect),document.querySelector("#btn-bscscan").addEventListener("click",function(){window.open("https://bscscan.com/address/"+selectedAccount,"_blank").focus()})});